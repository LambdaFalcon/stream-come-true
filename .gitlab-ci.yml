###############################################################################
# SETTINGS

# latest LTS that works well with create-react-app
image: node:10.15.3

stages:
  - build
  - test

cache:
  paths:
    - server/node_modules/
    - client/node_modules/

###############################################################################
# BUILD STAGE

server_build:
  stage: build
  script:
    - npm install --prefix ./server
    - npm build --prefix ./server

client_build:
  stage: build
  script:
    - npm install --prefix ./client
    - npm build --prefix ./client

###############################################################################
# TEST STAGE

server_test:
  stage: test
  script:
    - npm install --prefix ./server
    - npm test --prefix ./server

client_test:
  stage: test
  script:
    - npm install --prefix ./client
    - npm test --prefix ./client


